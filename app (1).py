
<-- Paste the full improved app.py code here (the long one I gave you above) -->
